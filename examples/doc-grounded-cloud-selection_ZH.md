# 示例：云服务商选型（文档驱动模式）

[English](doc-grounded-cloud-selection.md)

> 场景：某医疗健康 SaaS 初创公司需要为其新的 HIPAA 合规患者数据平台选择云服务商。与其他使用快速分析模式的示例不同，本示例演示的是**文档驱动模式** —— 准则从实际项目文档中提取，具备完整的来源可追溯性。

## Step 0: 决策输入模式选择

**选定模式**：A — 文档驱动分析

团队提供了以下材料：

| # | 来源文档 | 类型 | 关键内容 |
|---|---------|------|---------|
| D1 | `product_requirements.md` | 需求文档 | 功能需求、合规要求、预期用户规模 |
| D2 | `security_audit_checklist.pdf` | 合规文档 | HIPAA 要求、加密标准、审计追踪需求 |
| D3 | `infra_budget_2026.xlsx` | 预算方案 | 年度基础设施预算 $180K，增长预测 |
| D4 | AWS vs Azure vs GCP 医疗云对比（网络搜索） | 网络文章 | 医疗云服务逐项功能对比 |
| D5 | 团队技能调查结果 | 内部调查 | 70% AWS 经验，20% GCP，10% Azure |

### 从文档中提取准则

阅读全部 5 份来源材料后，提取出以下候选准则：

| 提取的准则 | 来源 | 证据 |
|-----------|------|------|
| HIPAA BAA 可用性 | D2, Section 2.1 | "云服务商必须提供已签署的商业伙伴协议（BAA）" |
| 数据加密（静态 + 传输中） | D2, Section 3.4 | "要求静态数据 AES-256 加密，传输中使用 TLS 1.3" |
| 审计日志与访问追踪 | D2, Section 4.2 | "所有 PHI 访问必须以不可篡改的审计追踪进行记录" |
| 患者负载峰值的自动扩缩容 | D1, Section 5 | "系统必须能承受流感季期间 10 倍正常负载" |
| 多区域故障转移 | D1, Section 6.3 | "灾难恢复要求 RPO < 1 小时，RTO < 15 分钟" |
| 年度成本控制在 $180K 预算内 | D3, Sheet "Projections" | "第 1 年基础设施预算：$180K，第 2 年随增长预计 $250K" |
| 预留实例/承诺折扣 | D3, Sheet "Savings" | "探索 1 年或 3 年承诺以实现成本节约" |
| 医疗专属 AI/ML 服务 | D1, Section 8 | "未来计划：集成医学影像 AI 和临床笔记 NLP" |
| FHIR API 支持 | D1, Section 7.2 | "必须支持 HL7 FHIR R4 以实现互操作性" |
| 团队现有云技能 | D5 | "70% 的团队成员拥有 AWS 认证；1 名 GCP 专家；Azure 经验极少" |
| 托管 Kubernetes 服务 | D1, Section 4.1 | "微服务架构，需要容器编排" |
| 合规认证广度 | D4, Web search | "对比各服务商的 SOC2、HITRUST、FedRAMP 认证" |

**τ (tau) 相关性过滤已应用**：
- ~~"Serverless 函数冷启动时间"~~ — 仅在 D4 中作为附带说明出现，与医疗平台的架构决策无关 → **已过滤**
- ~~"边缘计算可用性"~~ — D4 中提及但 D1 和 D2 中无相关需求 → **已过滤**

**提取 12 条准则 → τ 过滤后保留 10 条**

## Step 1: 决策框架构建

**决策目标**：选择最适合 HIPAA 合规医疗 SaaS 平台的云服务商

**评估层次**（由提取的 10 条准则组织而成）：

```
选择最佳医疗 SaaS 云服务商
├── 合规与安全 [D2]
│   ├── HIPAA BAA 与认证广度 [D2 §2.1, D4]
│   ├── 数据加密标准 [D2 §3.4]
│   └── 审计日志与访问控制 [D2 §4.2]
├── 技术适配性 [D1]
│   ├── 自动扩缩容能力 [D1 §5]
│   ├── 多区域故障转移 (RPO/RTO) [D1 §6.3]
│   └── 托管 Kubernetes 质量 [D1 §4.1]
├── 医疗生态系统 [D1, D4]
│   ├── 医疗 AI/ML 服务 [D1 §8]
│   └── FHIR API 与互操作性 [D1 §7.2]
└── 成本与团队 [D3, D5]
    ├── TCO 在预算约束内 [D3]
    └── 团队技能匹配 [D5]
```

注：每条准则均标注了来源文档以便追溯。

**备选方案**：
- **AWS**（Amazon Web Services）
- **Azure**（Microsoft Azure）
- **GCP**（Google Cloud Platform）

**用户优先级约束**：合规性不可妥协 —— "没有 HIPAA 合规，我们无法上线。"[D2, Executive Summary]

## Steps 2-3: 评估与聚合（精简版）

综合四个视角的评估：云架构师、CISO（安全负责人）、医疗领域专家和 CFO：

**共识权重**（已应用合规优先约束）：

```
合规与安全:    0.38 ███████████████████
技术适配性:    0.27 █████████████
医疗生态系统:  0.20 ██████████
成本与团队:    0.15 ███████
```

（"合规不可妥协"约束将合规与安全权重提升了 2 个等级）

## Step 4: 一致性校验

- 合规与安全 > 技术适配性 > 医疗生态系统 > 成本与团队 ✓
- 合规与安全 > 医疗生态系统 ✓（传递性满足）
- 技术适配性 > 成本与团队 ✓（传递性满足）
- 通过一致性检查 ✓

## Step 5: 方案评分

每项评分均基于文档证据（在可获得的情况下）：

| 子准则 | 权重 | AWS | Azure | GCP | 评分依据 |
|-------|------|-----|-------|-----|---------|
| HIPAA BAA 与认证 | 0.15 | 9 | 9 | 8 | [D4] AWS 与 Azure 具备 HITRUST；GCP 缺乏 HITRUST |
| 数据加密标准 | 0.12 | 9 | 9 | 9 | [D2 §3.4] 三者均满足 AES-256 + TLS 1.3 |
| 审计日志与访问 | 0.11 | 9 | 8 | 7 | [D4] AWS CloudTrail 最成熟；GCP 审计日志持续改进中 |
| 自动扩缩容 | 0.10 | 9 | 8 | 9 | [D1 §5] AWS 与 GCP 自动扩缩容能力同样出色 |
| 多区域故障转移 | 0.09 | 9 | 8 | 8 | [D1 §6.3] AWS 区域最多；三者均满足 RPO/RTO 目标 |
| 托管 Kubernetes | 0.08 | 8 | 7 | 9 | [D1 §4.1] GKE 被公认为最优秀的托管 K8s 服务 |
| 医疗 AI/ML | 0.11 | 8 | 9 | 8 | [D1 §8] Azure 拥有医疗专属 AI 模型（GCP 的 Med-PaLM 紧随其后） |
| FHIR API 支持 | 0.09 | 8 | 9 | 8 | [D1 §7.2] Azure FHIR Server 最成熟；AWS HealthLake 具有竞争力 |
| TCO 在预算内 | 0.08 | 7 | 7 | 8 | [D3] GCP 持续使用折扣最适合可预测工作负载 |
| 团队技能匹配 | 0.07 | 9 | 4 | 6 | [D5] 70% 团队成员拥有 AWS 认证 |

### 加权得分

| 方案 | 加权总分 |
|-----|---------|
| **AWS** | **8.47** |
| **Azure** | **7.88** |
| **GCP** | **7.85** |

### 敏感性分析

情景 A — 将"团队技能匹配"权重从 0.07 降至 0.02（愿意投入再培训）：
- AWS: 8.28 → 第 1
- Azure: 7.92 → 第 2
- GCP: 7.90 → 第 3

情景 B — 将"医疗生态系统"权重从 0.20 提升至 0.35（未来 AI/ML 路线图至关重要）：
- Azure: 8.15 → **第 1**（医疗 AI 优势凸显）
- AWS: 8.10 → 第 2（几乎持平）
- GCP: 7.88 → 第 3

**关键发现**：在基线情景下 AWS 稳居领先。仅当医疗专属生态系统成为主导因素时 Azure 才会反超。团队 70% 的 AWS 经验 [D5] 提供了难以忽视的强大实践优势。

## Step 6: 决策报告

# 决策报告：医疗 SaaS 云服务商选型

## 推荐方案
**AWS** — 综合得分：8.47 / 10

## 排名

| 排名 | 方案 | 得分 | 核心优势 |
|-----|------|------|---------|
| 1 | AWS | 8.47 | 最成熟的 HIPAA 工具链，团队匹配度最高，合规认证最广泛 |
| 2 | Azure | 7.88 | 最佳医疗专属生态系统（FHIR、医疗 AI），企业合规性强 |
| 3 | GCP | 7.85 | 最佳托管 Kubernetes，价格有竞争力，但医疗专属服务最薄弱 |

## 准则权重分布

| 准则 | 权重 | 来源文档 |
|-----|------|---------|
| 合规与安全 | 0.38 | D2: security_audit_checklist.pdf |
| 技术适配性 | 0.27 | D1: product_requirements.md |
| 医疗生态系统 | 0.20 | D1: product_requirements.md, D4: web search |
| 成本与团队 | 0.15 | D3: infra_budget_2026.xlsx, D5: team survey |

## 关键权衡
- **AWS vs Azure**：AWS 在合规成熟度和团队匹配方面领先；Azure 在医疗专属 AI/ML 服务方面领先。若 AI 路线图 [D1 §8] 加速推进，Azure 将更具吸引力
- **GCP 的 K8s 优势**：GKE 技术上更优秀，但团队需要大量再培训 [D5]，且 GCP 的医疗合规组合较薄弱 [D4]
- **团队技能因素**：70% 的 AWS 认证 [D5] 意味着更快的上市时间，以及在关键上线阶段更少的运维事故

## 风险评估
- AWS 的医疗 AI 服务落后于 Azure；建议为第 2 阶段 ML 路线图评估 Azure AI Health Insights [D1 §8]
- HIPAA 合规需要持续关注 —— 无论选择哪家服务商，都应安排季度合规审查 [D2]
- 预算预测 [D3] 显示第 2 年成本将增至 $250K；应尽早协商预留实例定价

## 信息来源
| 来源 | 描述 | 使用场景 |
|-----|------|---------|
| D1: product_requirements.md | 产品功能需求与规模目标 | 准则提取、评分 |
| D2: security_audit_checklist.pdf | HIPAA 合规要求 | 合规准则、优先级约束 |
| D3: infra_budget_2026.xlsx | 基础设施预算与预测 | 成本准则、预算约束 |
| D4: Web search results | 医疗云服务商对比文章 | 认证对比、评分 |
| D5: Team skills survey | 团队云技能分布 | 团队技能匹配评分 |

## 建议
1. 选择 AWS 作为主要云服务商
2. 第 1 周内完成 AWS HIPAA 合规服务配置并签署 BAA
3. 在 EKS（Elastic Kubernetes Service）上部署，采用多可用区配置
4. 预留 1 年期计算实例以控制在 $180K 的第 1 年预算内 [D3]
5. 评估 Azure AI Health Insights 作为第 2 阶段 ML 功能的跨云服务 [D1 §8]
6. 在第 12 个月安排一次云服务商重新评估，届时根据更新后的需求进行决策

---

## 本示例有何不同？

本示例使用的是**文档驱动模式（Mode A）**，而非快速分析模式。主要区别：

| 方面 | 快速分析（Mode B） | 文档驱动（Mode A，本示例） |
|-----|-------------------|-------------------------|
| 准则来源 | LLM 的通用知识 | 从实际项目文档中提取 |
| 可追溯性 | 无 — "基于领域知识" | 每条准则标注 `[来源: 文档, 章节]` |
| τ 过滤 | 不适用 | 已应用 — 过滤掉 2 条不相关准则 |
| 评分依据 | LLM 的评估判断 | 基于文档证据（在可获得的情况下） |
| 决策报告 | 通用建议 | 引用来源的建议，关联到具体文档 |
| 可复现性 | 取决于 LLM | 可审计 — 任何人都可以对照源文档验证准则 |
