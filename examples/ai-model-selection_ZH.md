# 示例：AI 基础模型 API 选型

> **核心 AHP 概念**：多视角分歧与共识 —— 4 个专家角色（ML 工程师、CTO、安全负责人、产品经理）产生截然不同的优先级排序，但几何平均聚合收敛为一个可辩护的共识。

[English](ai-model-selection.md)

> 场景：某 AI 创业公司正在构建智能客服平台，需要选择基础模型 API。团队共 8 人（ML 工程师 + 全栈开发），需处理多语言对话、文档理解和工作流自动化。预计调用量：每天 200 万次 API 调用。

## Step 1: 决策框架构建

**决策目标**：为生产级 AI 客服平台选择最合适的基础模型 API

**评估层次**：

```
选择最佳基础模型 API
├── 核心能力
│   ├── 语言理解与生成
│   ├── 推理准确性
│   └── 多模态能力（图像、文档）
├── 成本与效率
│   ├── API 定价（每百万 token）
│   ├── 响应延迟（P95）
│   └── 速率限制与吞吐量
├── 安全与合规
│   ├── 内容安全与防护机制
│   ├── 数据隐私政策
│   └── 法规合规（SOC2、GDPR）
└── 集成与运维
    ├── API 设计与 SDK 质量
    ├── 微调/定制化选项
    └── 供应商锁定风险
```

**备选方案**：
- **Claude** (Anthropic, Sonnet/Opus)
- **GPT-4o** (OpenAI)
- **Gemini** (Google, Pro/Ultra)
- **Llama 3** (Meta, 通过 vLLM 自托管)

## Step 2: 多视角评估

### 视角 1：ML 工程师

| vs | 核心能力 | 成本与效率 | 安全与合规 | 集成与运维 |
|----|---------|-----------|-----------|-----------|
| 核心能力 | 1 | 3 | 2 | 4 |
| 成本与效率 | 1/3 | 1 | 1/2 | 2 |
| 安全与合规 | 1/2 | 2 | 1 | 2 |
| 集成与运维 | 1/4 | 1/2 | 1/2 | 1 |

### 视角 2：CTO

| vs | 核心能力 | 成本与效率 | 安全与合规 | 集成与运维 |
|----|---------|-----------|-----------|-----------|
| 核心能力 | 1 | 2 | 1 | 2 |
| 成本与效率 | 1/2 | 1 | 1 | 2 |
| 安全与合规 | 1 | 1 | 1 | 3 |
| 集成与运维 | 1/2 | 1/2 | 1/3 | 1 |

### 视角 3：安全负责人

| vs | 核心能力 | 成本与效率 | 安全与合规 | 集成与运维 |
|----|---------|-----------|-----------|-----------|
| 核心能力 | 1 | 1/2 | 1/3 | 1 |
| 成本与效率 | 2 | 1 | 1/3 | 2 |
| 安全与合规 | 3 | 3 | 1 | 4 |
| 集成与运维 | 1 | 1/2 | 1/4 | 1 |

### 视角 4：产品经理

| vs | 核心能力 | 成本与效率 | 安全与合规 | 集成与运维 |
|----|---------|-----------|-----------|-----------|
| 核心能力 | 1 | 2 | 3 | 3 |
| 成本与效率 | 1/2 | 1 | 2 | 2 |
| 安全与合规 | 1/3 | 1/2 | 1 | 1 |
| 集成与运维 | 1/3 | 1/2 | 1 | 1 |

## Step 3: 共识聚合

### 几何平均矩阵

| vs | 核心能力 | 成本与效率 | 安全与合规 | 集成与运维 |
|----|---------|-----------|-----------|-----------|
| 核心能力 | 1 | 1.73 | 1.19 | 2.21 |
| 成本与效率 | 0.58 | 1 | 0.64 | 2.00 |
| 安全与合规 | 0.84 | 1.57 | 1 | 2.21 |
| 集成与运维 | 0.45 | 0.50 | 0.45 | 1 |

### 权重计算

| 准则 | 行几何平均 | 归一化权重 |
|-----|-----------|----------|
| 核心能力 | 1.45 | 0.34 |
| 成本与效率 | 0.95 | 0.22 |
| 安全与合规 | 1.30 | 0.30 |
| 集成与运维 | 0.56 | 0.14 |

**权重分布**：
```
核心能力:      0.34 █████████████████
安全与合规:    0.30 ███████████████
成本与效率:    0.22 ███████████
集成与运维:    0.14 ███████
```

## Step 4: 一致性校验

**传递性检查**：
- 核心能力 > 安全与合规 > 成本与效率 > 集成与运维 ✓
- 核心能力 > 成本与效率 ✓
- 安全与合规 > 集成与运维 ✓
- 所有传递关系一致 ✓

**结论**：比较矩阵通过一致性检查。

## Step 5: 方案评分

| 子准则 | 权重 | Claude | GPT-4o | Gemini | Llama 3 |
|-------|------|--------|--------|--------|---------|
| 语言理解 | 0.13 | 9 | 9 | 8 | 7 |
| 推理准确性 | 0.12 | 9 | 8 | 8 | 6 |
| 多模态能力 | 0.09 | 8 | 9 | 9 | 6 |
| API 定价 | 0.09 | 7 | 6 | 8 | 9 |
| 响应延迟 | 0.07 | 7 | 8 | 8 | 7 |
| 速率限制与吞吐量 | 0.06 | 7 | 8 | 8 | 9 |
| 内容安全 | 0.12 | 9 | 8 | 8 | 5 |
| 数据隐私 | 0.10 | 9 | 7 | 6 | 10 |
| 法规合规 | 0.08 | 8 | 8 | 7 | 6 |
| API 与 SDK 质量 | 0.05 | 8 | 9 | 7 | 6 |
| 微调选项 | 0.05 | 6 | 8 | 7 | 9 |
| 供应商锁定风险 | 0.04 | 6 | 5 | 5 | 10 |

### 加权得分

| 方案 | 加权总分 |
|-----|---------|
| **Claude** | **8.07** |
| **GPT-4o** | **7.87** |
| **Gemini** | **7.59** |
| **Llama 3** | **7.24** |

### 敏感性分析

场景 A — 将"安全与合规"权重从 0.30 降至 0.15（监管较宽松的行业）：
- GPT-4o: 7.85 → 第 1
- Claude: 7.80 → 第 2（差距显著缩小）
- Gemini: 7.65 → 第 3
- Llama 3: 7.42 → 第 4

场景 B — 将"成本与效率"权重从 0.22 提升至 0.35（预算受限的初创公司）：
- Llama 3: 7.55 → 跃升至第 2
- Claude: 7.72 → 仍为第 1
- Gemini: 7.60 → 第 2
- GPT-4o: 7.35 → 降至第 4

**关键发现**：Claude 在安全敏感场景中优势稳固；在成本主导的场景中，Llama 3 和 Gemini 具备较强竞争力。

## Step 6: 决策报告

# 决策报告：AI 基础模型 API 选型

## 推荐方案
**Claude (Anthropic)** — 综合得分：8.07 / 10

## 排名

| 排名 | 方案 | 得分 | 核心优势 |
|-----|------|------|---------|
| 1 | Claude | 8.07 | 推理准确性最优，安全防护机制最强，数据隐私领先 |
| 2 | GPT-4o | 7.87 | 多模态能力最全面，SDK/工具生态最完善，采用范围最广 |
| 3 | Gemini | 7.59 | 定价有竞争力，多模态能力强，大规模吞吐量表现好 |
| 4 | Llama 3 | 7.24 | 数据主权完全自主，规模化后零 API 成本，定制化能力最强 |

## 关键权衡
- **Claude vs GPT-4o**：Claude 在安全和推理方面领先；GPT-4o 在多模态广度和生态工具方面领先。0.20 分的差距主要由安全与隐私权重驱动
- **托管服务 vs 自托管**：Llama 3 在数据主权和规模化成本控制方面无可匹敌，但需要大量 ML 基础设施投入（GPU 集群、模型服务、监控）
- **Gemini 作为黑马**：在大规模调用量下定价最具竞争力，对已在 GCP 上的团队有 Google Cloud 集成优势

## 风险提示
- Claude 的微调选项目前比 GPT-4o 更有限；复杂的定制化需求可能需要借助巧妙的 Prompt 工程
- 依赖单一模型供应商存在集中风险；应设计抽象层以便快速切换供应商
- Llama 3 自托管需要 2-3 名专职 ML 工程师负责运维

## 建议
1. 采用 Claude 作为所有面向客户对话的主要模型
2. 实现模型抽象层（如 LiteLLM），支持多供应商故障切换
3. 使用 Llama 3 自托管作为低风险任务（分类、摘要）的高性价比备选方案
4. 每季度重新评估，因模型领域发展极为迅速
